#!/bin/bash

# Muestra todas las claves en $PASSWORD_STORE_DIR excluyendo la carpeta otp
selec=$(find "$PASSWORD_STORE_DIR/" -type f -name '*.gpg' -exec basename {} .gpg \; | tofi)
[ -z $selec ] && exit 0

# Logra el enlace al archivo seleccionado
path=$(find "$PASSWORD_STORE_DIR/" -type f -name "$selec.gpg" | grep -oP "^$PASSWORD_STORE_DIR/\K.*(?=\.gpg$)")

# Muestra las opciones en tofi
selected=$(printf "Usuario\nClave" | tofi)

# Comprobar las opciones y ejecutar los comandos
case $selected in
    "Usuario")
		pass -c2 $path && notify-send "Usuario copiado" ;;
    "Clave")
		pass -c1 $path && notify-send "Contrase√±a copiada" ;;
    *)
		exit 0 ;;
esac
